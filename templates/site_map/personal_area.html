{% extends 'site_map/base.html' %}
{% load static %}
{% block title %}Личный кабинет{% endblock %}
{% block lib %}
    <script src="{% static "js/lk.js" %}" type="text/javascript"></script>
    <script src="{% static "js/reset_map.js" %}" type="text/javascript"></script>
    <script src="{% static "js/add_coords.js" %}" type="text/javascript"></script>
{% endblock %}
{% block style %}

{% endblock %}
{% block content %}
    <body class="bg-light">
    <div class="container">
        <main>
            <div class="py-5 text-center">
                <h2>Личный кабинет</h2>
            </div>
            <div class="container">
                <h4 class="mb-3">Личная информация</h4>
                <form enctype="multipart/form-data" method="POST" action="">
                    {% csrf_token %}
                    <div class="row g-3">
                        <div class="col-sm-6">
                            <label for="firstName" class="form-label">Имя</label>
                            <input type="text" class="form-control" name="first_name" id="firstName" placeholder="Иван"
                                   value="{{ user.user.first_name }}">
                            <div class="invalid-feedback">
                                Valid first name is required.
                            </div>
                        </div>

                        <div class="col-sm-6">
                            <label for="lastName" class="form-label">Фамилия</label>
                            <input type="text" class="form-control" name="last_name" id="lastName" placeholder="Иванов"
                                   value="{{ user.user.last_name }}">
                            <div class="invalid-feedback">
                                Valid last name is required.
                            </div>
                        </div>

                        <div class="col-sm-6">
                            <label for="username" class="form-label">Отчество</label>
                            <div class="input-group has-validation">
                                <input type="text" class="form-control" name="patronymic" id="patronymic"
                                       placeholder="Иванович" value="{{ user.patronymic }}">
                                <div class="invalid-feedback">
                                    Your username is required.
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <label for="username" class="form-label">Пароль</label>
                            <div class="input-group has-validation">
                                <input type="password" class="form-control" name="password" id="password"
                                       placeholder="Новый пароль">
                                <div class="invalid-feedback">
                                    Your username is required.
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <label for="email" class="form-label">Почта</label>
                            <input type="email" class="form-control" id="email" name="email"
                                   placeholder="you@example.com"
                                   value="{{ user.user.email }}">
                            <div class="invalid-feedback">
                                Please enter a valid email address for shipping updates.
                            </div>
                        </div>


                        <div class="col-sm-6">
                            <input style="width: 200px" type="button" class="btn btn-dark" value="Показать карту"
                                   id="toggle"/>
                            <p></p>
                            <div id="map" style="width: 500px; height: 300px"></div>
                            <input type="hidden" id="map_coords" name="map_coords"
                                   value="{{ user.card.coords_x }},{{ user.card.coords_y }}">
                            <input type="hidden" id="map_address" name="map_address" value="{{ user.card.name }}">
                            <input type="hidden" id="filter_coords" name="filter_coords">

                        </div>
                        <div class="col-sm-6">
                            <input id="im1" name="image" type="file" accept="image/*">
                            {% if user.photo.image %}
                                <img style="border-radius: 50px;" height="150" width="150"
                                     src="{{ user.photo.image.url }}" alt="Картинка">
                            {% endif %}
                        </div>
                        <div class="col-12">
                            <label>
                                <select id="delete_map">
                                    <option value="0">Выберите точку для удаления</option>
                                    {% for el in coords %}
                                        <option value="{{ el.id }}">{{ el.address }}</option>
                                    {% endfor %}
                                </select>
                            </label>
                            <button type="button" onclick="f()">Удалить точку</button>
                            <button type="button" onclick="add_coords()">Добавить точку</button>
                        </div>
                    </div>
                    <button class="w-100 btn btn-primary btn-lg" type="submit">Сохранить изменения</button>
                </form>
                {% for message in messages %}
                    <p id="messages">{{ message }}</p>
                {% endfor %}
            </div>
        </main>
    </div>
    </body>
{% endblock %}
